<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Functional on Paul Cassidy Software Developer</title>
    <link>https://qawarrior.github.io/tags/functional/index.xml</link>
    <description>Recent content in Functional on Paul Cassidy Software Developer</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016 Paul H Cassidy</copyright>
    <atom:link href="/tags/functional/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Solved: Powershell fails as a functional language if commands are in modules.</title>
      <link>https://qawarrior.github.io/2011/01/04/solved-powershell-fails-as-a-functional-language-if-commands-are-in-modules.</link>
      <pubDate>Tue, 04 Jan 2011 14:13:00 +0000</pubDate>
      
      <guid>https://qawarrior.github.io/2011/01/04/solved-powershell-fails-as-a-functional-language-if-commands-are-in-modules.</guid>
      <description>&lt;p&gt;&lt;p&gt;&amp;#160;&lt;/p&gt;  &lt;p&gt;the issue comes down to the scope that the scriptblock being passed into the function gets bound. In the original example the scriptblock was being bound to the callers scope which can not access anything in the module except what was imported into the scope. The fix turns out to be explicitly binding the scriptblock to the modules scope. See the fixed example below. Thanks go out to @Oisin for the fix.&lt;/p&gt;  &lt;pre&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;New-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;lsquo;&lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;Testing&lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;lsquo;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-ScriptBlock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; {&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000cd&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;                       [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;                       [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;scriptblock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               )&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000cd&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;                       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;                               [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;int&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;                       )&lt;br /&gt;                       &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               }&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Mod&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #ff0000&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Get-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;Testing&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; ( &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Mod&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color: #8b4513&#34;&gt;NewBoundScriptBlock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;) )&lt;br /&gt;       }&lt;br /&gt;} &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Import-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Force&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Global&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; { &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; }&lt;br /&gt;&lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Remove-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;Testing&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Force&lt;/span&gt;&lt;/pre&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Powershell fails as a functional language if commands are in modules.</title>
      <link>https://qawarrior.github.io/2011/01/04/powershell-fails-as-a-functional-language-if-commands-are-in-modules.</link>
      <pubDate>Tue, 04 Jan 2011 09:57:00 +0000</pubDate>
      
      <guid>https://qawarrior.github.io/2011/01/04/powershell-fails-as-a-functional-language-if-commands-are-in-modules.</guid>
      <description>&lt;p&gt;&lt;p&gt;I have some functions that contain functions. When I put the Functions in a .ps1 file and Dot Source directly the behave great but if those functions get imported in a module they fail to find the inner function with a CommandNotFound error. It does not matter if the functions are directly in a .psm1 file or if they are dot sourced by the .psm1 file they still fail to find the inner functions. Here are some code examples. Why is this? You can copy the below code into Powershell Console or ISE and run to see the errors.&lt;/p&gt;  &lt;pre&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;               [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;scriptblock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;       )&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000cd&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;                       [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;int&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               )&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;       }&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;}&lt;br /&gt;&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; { &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; }&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;New-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;lsquo;&lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;Testing&lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;lsquo;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-ScriptBlock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; {&lt;br /&gt;       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000cd&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;                       [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;                       [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;scriptblock&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               )&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;function&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #0000cd&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;{&lt;br /&gt;                       &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;param&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;(&lt;br /&gt;                               [&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;int&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;                       )&lt;br /&gt;                       &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               }&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Write-Host&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;               &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800080&#34;&gt;$TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;       }&lt;br /&gt;} &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;|&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;Import-Module&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Force&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Global&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestOuter&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Name&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #800000&#34;&gt;&amp;quot;Paul&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-TestScript&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; { &lt;/span&gt;&lt;span style=&#34;color: #0000ff&#34;&gt;TestInner&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #5f9ea0&#34;&gt;-Count&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt;10&lt;/span&gt;&lt;span style=&#34;color: #000000&#34;&gt; }&lt;br /&gt;&lt;/span&gt;&lt;/pre&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
